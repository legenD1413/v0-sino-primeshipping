# Postmark 邮件系统配置说明

## 📧 功能概述

SPS 管理后台的 Postmark 邮件系统支持完整的邮件配置，包括发件人、收件人、抄送和密抄功能。

## 🔧 配置字段说明

### 基础配置

#### 1. API 令牌
- **字段名**: API 令牌
- **必填**: 是
- **默认值**: `68ef6c85-6260-4277-8527-530727b0cc22`
- **说明**: 从 Postmark 控制台获取的服务器 API 令牌

#### 2. 发件人邮箱
- **字段名**: 发件人邮箱
- **必填**: 是
- **默认值**: `noreply@sinoprimeshipping.com`
- **说明**: 邮件的发送地址，必须是已验证的域名

#### 3. 回复邮箱
- **字段名**: 回复邮箱
- **必填**: 否
- **默认值**: `support@sinoprimeshipping.com`
- **说明**: 用户回复邮件时的接收地址

#### 4. 消息流
- **字段名**: 消息流
- **必填**: 否
- **默认值**: `outbound`
- **说明**: Postmark 消息流标识符

### 邮件接收者配置

#### 5. 收件箱 (To)
- **字段名**: 收件箱
- **必填**: 否
- **默认值**: 空
- **说明**: 主要收件人邮箱地址
- **使用说明**: 
  - 如果设置，测试邮件将发送到此地址
  - 如果未设置，将发送到测试邮件地址
  - 支持单个邮箱地址

#### 6. 抄送邮箱 (CC)
- **字段名**: 抄送邮箱 (CC)
- **必填**: 否
- **默认值**: 空
- **说明**: 抄送收件人邮箱地址
- **使用说明**:
  - 抄送收件人可以看到邮件
  - 其他收件人可以看到抄送收件人的邮箱
  - 支持单个邮箱地址

#### 7. 密抄邮箱 (BCC)
- **字段名**: 密抄邮箱 (BCC)
- **必填**: 否
- **默认值**: 空
- **说明**: 密抄收件人邮箱地址
- **使用说明**:
  - 密抄收件人可以收到邮件
  - 其他收件人看不到密抄收件人的邮箱
  - 支持单个邮箱地址

## 📝 操作指南

### 配置步骤

1. **登录管理后台**
   ```
   访问：http://localhost:3000/sps-admin
   用户名：admin
   密码：sps2024!
   ```

2. **切换到邮件系统选项卡**
   - 点击"邮件系统"标签

3. **填写基础配置**
   - API 令牌：已预设，无需修改
   - 发件人邮箱：已预设，可根据需要修改
   - 回复邮箱：已预设，可根据需要修改
   - 消息流：保持默认值 `outbound`

4. **配置邮件接收者**
   - 收件箱：输入主要收件人邮箱
   - 抄送邮箱：输入需要抄送的邮箱（可选）
   - 密抄邮箱：输入需要密抄的邮箱（可选）

5. **保存配置**
   - 点击"保存配置"按钮
   - 配置会自动保存到浏览器本地存储

### 测试邮件

1. **输入测试邮件地址**
   - 在"测试邮件地址"字段输入您的邮箱

2. **发送测试邮件**
   - 点击"发送测试邮件"按钮
   - 系统会根据配置发送测试邮件

3. **验证邮件接收**
   - 检查收件箱是否收到邮件
   - 检查抄送邮箱是否收到邮件（如果配置了）
   - 检查密抄邮箱是否收到邮件（如果配置了）

## 📊 配置预览

系统会实时显示当前配置状态：

```
API令牌: 已配置
发件人: noreply@sinoprimeshipping.com
回复地址: support@sinoprimeshipping.com
消息流: outbound
收件箱: user@company.com
抄送邮箱: manager@company.com
密抄邮箱: archive@company.com
```

## ⚠️ 重要注意事项

### 邮箱验证
- 所有邮箱地址必须是有效格式
- 发件人邮箱必须在 Postmark 中验证
- 建议使用企业邮箱地址

### 隐私和安全
- 密抄邮箱地址对其他收件人不可见
- 敏感邮件建议使用密抄功能
- 定期检查和更新邮箱配置

### 配置持久化
- 配置会自动保存到浏览器本地存储
- 清除浏览器数据会丢失配置
- 建议记录重要配置信息

## 🔍 故障排除

### 常见问题

#### 1. 邮件发送失败
- 检查 API 令牌是否正确
- 确认发件人邮箱已验证
- 检查网络连接

#### 2. 收不到邮件
- 检查垃圾邮件文件夹
- 确认邮箱地址格式正确
- 验证收件人邮箱是否有效

#### 3. 抄送/密抄失效
- 确认邮箱地址格式正确
- 检查 Postmark 账户限制
- 验证邮箱服务商设置

### 错误代码

- `400`: 缺少必需字段
- `401`: API 令牌无效
- `422`: 邮箱地址格式错误
- `500`: 服务器内部错误

## 📞 技术支持

如需技术支持，请联系：
- 邮箱：admin@sinoprimeshipping.com
- 系统日志：查看浏览器开发者工具控制台

---

*最后更新：2024年1月* 